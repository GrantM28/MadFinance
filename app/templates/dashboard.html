{% extends 'base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold">Financial Strategy Engine</h2>
    <span class="badge bg-success bg-opacity-10 text-success p-2">Status: Optimal</span>
</div>

<div class="row g-4 mb-5">
    <div class="col-md-3">
        <div class="stat-card text-center">
            <div class="metric-label">Monthly Income</div>
            <div class="metric-value text-primary">${{ "%.2f"|format(summary.income) }}</div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card text-center">
            <div class="metric-label">Total Debt</div>
            <div class="metric-value text-danger">${{ "%.2f"|format(summary.total_debt) }}</div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card text-center">
            <div class="metric-label">Free Cashflow</div>
            <div class="metric-value text-success">${{ "%.2f"|format(summary.cashflow) }}</div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card text-center">
            <div class="metric-label">DTI Ratio</div>
            <div class="metric-value {{ 'text-danger' if summary.dti > 36 else 'text-info' }}">{{ "%.1f"|format(summary.dti) }}%</div>
        </div>
    </div>
</div>

<div class="row g-4">
    <div class="col-lg-6">
        <div class="stat-card h-100">
            <h5 class="mb-4 fw-bold">DTI Health Allocation</h5>
            <div class="chart-container">
                <canvas id="dtiChart"></canvas>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="stat-card mb-4">
            <h5 class="fw-bold"><i class="bi bi-lightning-charge text-warning"></i> Strategy Recommendations</h5>
            <div class="mt-3">
                <div class="alert alert-info border-0 bg-info bg-opacity-10 text-info small">
                    <i class="bi bi-info-circle me-2"></i> Consider the <strong>Avalanche Method</strong> for your BHG Loan to save on interest.
                </div>
                <div class="alert alert-primary border-0 bg-primary bg-opacity-10 text-primary small">
                    <i class="bi bi-shield-check me-2"></i> Your DTI is at {{ "%.1f"|format(summary.dti) }}%. Aim for under 36% for mortgage safety.
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='script.js') }}"></script>
<script>
    // Passing Flask data to JS for the Chart
    initDtiChart({{ summary.income - summary.cashflow }}, {{ summary.cashflow }});
</script>
{% endblock %}